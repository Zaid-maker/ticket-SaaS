---
title: Deployment
description: Deploy the Ticket Marketplace SaaS to production
---

# Deployment

This guide explains how to deploy the Ticket Marketplace SaaS application to production.

## Prerequisites

Before deploying, ensure you have:

- ✅ All code tested and working locally
- ✅ Database setup and migrations tested
- ✅ Environment variables configured
- ✅ Production database ready
- ✅ Domain name (optional, recommended)
- ✅ SSL certificate (automatic with most platforms)

## Deployment Platforms

### Vercel (Recommended)

Vercel is the easiest platform for deploying Next.js applications.

#### 1. Install Vercel CLI

```bash
npm install -g vercel
```

#### 2. Login to Vercel

```bash
vercel login
```

#### 3. Deploy

```bash
cd ticket-SaaS
vercel
```

Follow the prompts to configure your project.

#### 4. Set Environment Variables

In your Vercel dashboard:

1. Go to your project settings
2. Navigate to "Environment Variables"
3. Add all required variables:

```
NODE_ENV=production
DATABASE_URL=postgresql://user:pass@host:5432/db
BETTER_AUTH_SECRET=your-production-secret
BETTER_AUTH_URL=https://your-domain.vercel.app
GITHUB_CLIENT_ID=your-github-client-id
GITHUB_CLIENT_SECRET=your-github-client-secret
```

**Important:** Do NOT set `NEXT_PUBLIC_BETTER_AUTH_URL` in production

#### 5. Deploy to Production

```bash
vercel --prod
```

#### 6. Run Database Migrations

After deployment, run migrations:

```bash
npx prisma migrate deploy
```

If using Vercel Postgres, set the connection string in your environment variables.

---

### Netlify

Deploy to Netlify with the following steps:

#### 1. Install Netlify CLI

```bash
npm install -g netlify-cli
```

#### 2. Build for Production

```bash
npm run build
```

#### 3. Deploy

```bash
netlify deploy --prod
```

#### 4. Configure Environment Variables

In Netlify dashboard, add environment variables under Site Settings > Environment Variables.

---

### Railway

Railway provides easy PostgreSQL integration.

#### 1. Install Railway CLI

```bash
npm install -g @railway/cli
```

#### 2. Initialize Project

```bash
railway init
```

#### 3. Add PostgreSQL

```bash
railway add postgresql
```

This automatically sets `DATABASE_URL`.

#### 4. Set Environment Variables

```bash
railway variables set BETTER_AUTH_SECRET=your-secret
railway variables set BETTER_AUTH_URL=https://your-domain.up.railway.app
# ... other variables
```

#### 5. Deploy

```bash
railway up
```

---

### Docker

Deploy using Docker for more control.

#### 1. Create Dockerfile

```dockerfile
# Dockerfile
FROM node:20-alpine AS base

# Install dependencies
FROM base AS deps
RUN apk add --no-cache libc6-compat
WORKDIR /app

COPY package*.json ./
RUN npm ci

# Build application
FROM base AS builder
WORKDIR /app
COPY --from=deps /app/node_modules ./node_modules
COPY . .

# Generate Prisma Client
RUN npx prisma generate

# Build Next.js
RUN npm run build

# Production image
FROM base AS runner
WORKDIR /app

ENV NODE_ENV=production

RUN addgroup --system --gid 1001 nodejs
RUN adduser --system --uid 1001 nextjs

COPY --from=builder /app/public ./public
COPY --from=builder /app/.next/standalone ./
COPY --from=builder /app/.next/static ./.next/static

USER nextjs

EXPOSE 3000

ENV PORT=3000

CMD ["node", "server.js"]
```

#### 2. Create docker-compose.yml

```yaml
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - DATABASE_URL=postgresql://postgres:password@db:5432/ticketsaas
      - BETTER_AUTH_SECRET=${BETTER_AUTH_SECRET}
      - BETTER_AUTH_URL=${BETTER_AUTH_URL}
      - GITHUB_CLIENT_ID=${GITHUB_CLIENT_ID}
      - GITHUB_CLIENT_SECRET=${GITHUB_CLIENT_SECRET}
    depends_on:
      - db

  db:
    image: postgres:16-alpine
    environment:
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=password
      - POSTGRES_DB=ticketsaas
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

volumes:
  postgres_data:
```

#### 3. Build and Run

```bash
docker-compose up -d
```

#### 4. Run Migrations

```bash
docker-compose exec app npx prisma migrate deploy
```

---

## Database Setup

### PostgreSQL Hosting Options

**Vercel Postgres:**
- Integrated with Vercel
- Automatic connection string
- Easy scaling

**Supabase:**
- Free tier available
- PostgreSQL with additional features
- Dashboard for management

**Railway:**
- Simple setup
- Automatic backups
- Good free tier

**Neon:**
- Serverless PostgreSQL
- Generous free tier
- Branch databases for development

**AWS RDS:**
- Enterprise-grade
- Full control
- More expensive

### Database Migration

After setting up your production database:

```bash
# Set DATABASE_URL environment variable
export DATABASE_URL="postgresql://user:pass@host:5432/db"

# Run migrations
npx prisma migrate deploy

# Optional: Seed with demo data
npx prisma db seed
```

---

## Environment Variables

### Required Variables

```bash
# Application
NODE_ENV=production

# Database
DATABASE_URL=postgresql://user:password@host:5432/database

# Better Auth
BETTER_AUTH_SECRET=generate-with-openssl-rand-base64-32
BETTER_AUTH_URL=https://your-production-domain.com

# GitHub OAuth (optional)
GITHUB_CLIENT_ID=your-github-oauth-client-id
GITHUB_CLIENT_SECRET=your-github-oauth-client-secret
```

### Generate Secrets

```bash
# Generate BETTER_AUTH_SECRET
openssl rand -base64 32
```

### Important Notes

- **Never commit `.env` files** to version control
- **Use platform-specific secret management** (Vercel Secrets, Railway Variables, etc.)
- **Do NOT set `NEXT_PUBLIC_BETTER_AUTH_URL`** in production (uses relative URLs)
- **Update GitHub OAuth callback URL** to production domain

---

## Pre-Deployment Checklist

### Code Quality

- [ ] All tests passing
- [ ] Linter passing: `npm run lint`
- [ ] TypeScript compiling: `npm run build`
- [ ] No console.logs in production code
- [ ] Error handling implemented
- [ ] Loading states implemented

### Security

- [ ] Strong `BETTER_AUTH_SECRET` generated
- [ ] Environment variables secured
- [ ] Rate limiting enabled
- [ ] HTTPS configured
- [ ] CORS configured if needed
- [ ] Input validation on all forms
- [ ] SQL injection prevention (using Prisma)
- [ ] XSS prevention

### Database

- [ ] Production database created
- [ ] Connection string secured
- [ ] Migrations tested
- [ ] Backup strategy in place
- [ ] Connection pooling configured

### Performance

- [ ] Images optimized
- [ ] Static assets compressed
- [ ] Database queries optimized
- [ ] Caching strategy implemented
- [ ] CDN configured (automatic with Vercel/Netlify)

### Monitoring

- [ ] Error tracking setup (Sentry, LogRocket)
- [ ] Analytics configured (Google Analytics, Plausible)
- [ ] Uptime monitoring (UptimeRobot, Pingdom)
- [ ] Log aggregation (Papertrail, Logtail)

---

## Post-Deployment

### 1. Verify Deployment

Test critical functionality:

- [ ] Homepage loads correctly
- [ ] Sign up works
- [ ] Sign in works
- [ ] Browse tickets works
- [ ] Create ticket works (authenticated)
- [ ] Purchase works (authenticated)
- [ ] Dashboard loads (authenticated)

### 2. Update GitHub OAuth

If using GitHub OAuth, update callback URL:

1. Go to https://github.com/settings/developers
2. Select your OAuth App
3. Update **Authorization callback URL**: `https://your-domain.com/api/auth/callback/github`

### 3. Test Authentication

- [ ] Sign up with email/password
- [ ] Sign in with email/password
- [ ] Sign up with GitHub OAuth
- [ ] Sign in with GitHub OAuth
- [ ] Sign out

### 4. Monitor Logs

Check logs for:
- Any errors
- Slow queries
- Rate limit violations
- Authentication issues

### 5. Performance Testing

Use tools like:
- Google PageSpeed Insights
- WebPageTest
- Lighthouse

Aim for:
- First Contentful Paint < 1.8s
- Time to Interactive < 3.9s
- Largest Contentful Paint < 2.5s

---

## Continuous Deployment

### GitHub Actions

Create `.github/workflows/deploy.yml`:

```yaml
name: Deploy to Production

on:
  push:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    
    steps:
      - uses: actions/checkout@v3
      
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          
      - name: Install dependencies
        run: npm ci
        
      - name: Run linter
        run: npm run lint
        
      - name: Build
        run: npm run build
        
      - name: Deploy to Vercel
        uses: amondnet/vercel-action@v20
        with:
          vercel-token: ${{ secrets.VERCEL_TOKEN }}
          vercel-org-id: ${{ secrets.VERCEL_ORG_ID }}
          vercel-project-id: ${{ secrets.VERCEL_PROJECT_ID }}
          vercel-args: '--prod'
```

---

## Rollback Strategy

### Vercel

View previous deployments and rollback:

```bash
vercel rollback
```

Or in the dashboard: Deployments > Previous deployment > Promote to Production

### Docker

Keep previous image tags:

```bash
# Tag current image
docker tag app:latest app:v1.0.0

# Rollback to previous version
docker-compose down
docker-compose up -d app:v0.9.0
```

---

## Scaling

### Horizontal Scaling

**Vercel/Netlify:**
- Automatic scaling included
- Serverless functions scale on demand

**Docker/Kubernetes:**
- Add more container instances
- Use load balancer (nginx, HAProxy)
- Configure session sharing (Redis)

### Database Scaling

**Connection Pooling:**
```typescript
// In production, use connection pooling
const prisma = new PrismaClient({
  datasources: {
    db: {
      url: `${process.env.DATABASE_URL}?pgbouncer=true`,
    },
  },
});
```

**Read Replicas:**
```typescript
// Separate read/write connections
const writeClient = new PrismaClient({
  datasources: { db: { url: process.env.DATABASE_WRITE_URL } },
});

const readClient = new PrismaClient({
  datasources: { db: { url: process.env.DATABASE_READ_URL } },
});
```

### Caching

**Redis for rate limiting:**
```bash
# Add Redis to Railway
railway add redis

# Update rate limiting to use Redis
REDIS_URL=redis://...
```

---

## Troubleshooting

### Build Failures

**Issue:** Prisma client not generated

**Solution:**
```bash
npx prisma generate
```

**Issue:** Type errors during build

**Solution:**
```bash
npm run build
# Fix any TypeScript errors shown
```

### Database Connection Issues

**Issue:** Cannot connect to database

**Solutions:**
- Verify `DATABASE_URL` is correct
- Check database is accessible from deployment platform
- Verify firewall rules allow connections
- Check SSL settings (add `?sslmode=require` if needed)

### Authentication Not Working

**Issue:** Users can't sign in

**Solutions:**
- Verify `BETTER_AUTH_SECRET` is set
- Check `BETTER_AUTH_URL` matches production domain
- Remove `NEXT_PUBLIC_BETTER_AUTH_URL` if set
- Clear cookies and try again

### GitHub OAuth Fails

**Issue:** GitHub OAuth returns error

**Solutions:**
- Verify callback URL matches in GitHub settings
- Check `GITHUB_CLIENT_ID` and `GITHUB_CLIENT_SECRET`
- Ensure OAuth app is not suspended

---

## Monitoring & Maintenance

### Error Tracking

**Sentry Setup:**
```bash
npm install @sentry/nextjs
npx @sentry/wizard -i nextjs
```

### Uptime Monitoring

Use services like:
- UptimeRobot (free)
- Pingdom
- Better Uptime

### Database Backups

**Automated Backups:**
- Vercel Postgres: Automatic daily backups
- Railway: Automatic backups on paid plans
- Manual: Set up cron job for `pg_dump`

```bash
# Manual backup script
pg_dump $DATABASE_URL > backup-$(date +%Y%m%d).sql
```

### Log Management

**View Logs:**

**Vercel:**
```bash
vercel logs
```

**Railway:**
```bash
railway logs
```

**Docker:**
```bash
docker-compose logs -f app
```

---

## Security Hardening

### Production Checklist

- [ ] HTTPS enforced (automatic with most platforms)
- [ ] HSTS headers enabled (included in config)
- [ ] Rate limiting active
- [ ] Environment variables secured
- [ ] Database credentials rotated regularly
- [ ] Dependency updates automated (Dependabot)
- [ ] Security headers configured
- [ ] CORS properly configured
- [ ] Content Security Policy (CSP) implemented

### Regular Maintenance

**Weekly:**
- Review error logs
- Check uptime reports
- Monitor rate limit violations

**Monthly:**
- Update dependencies: `npm update`
- Review security advisories: `npm audit`
- Database backup verification
- Performance audit

**Quarterly:**
- Rotate secrets and credentials
- Security audit
- Load testing
- Disaster recovery drill

---

## Next Steps

- [Configuration](/docs/configuration) - Environment variables reference
- [Database](/docs/database) - Database management
- [API Reference](/docs/api) - API documentation
- [Rate Limiting](/docs/rate-limiting) - Rate limiting details
