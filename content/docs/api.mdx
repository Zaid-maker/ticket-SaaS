---
title: API Reference
description: Complete API documentation for the Ticket Marketplace SaaS
---

# API Reference

Complete API documentation for interacting with the Ticket Marketplace SaaS platform.

## Base URL

```
Development: http://localhost:3000/api
Production: https://yourdomain.com/api
```

## Authentication

Most API endpoints require authentication via session cookies. Authenticate using the Better Auth endpoints before making requests to protected routes.

**Authentication Header:** Session cookies are automatically included in requests.

## Response Format

All API responses follow a consistent format:

**Success Response:**
```json
{
  "data": { /* response data */ },
  "status": 200
}
```

**Error Response:**
```json
{
  "error": "Error message",
  "status": 400
}
```

## Rate Limiting

All endpoints are rate-limited to prevent abuse. Rate limit headers are included in responses:

```
X-RateLimit-Limit: 30
X-RateLimit-Remaining: 29
X-RateLimit-Reset: 2025-10-10T21:00:00.000Z
```

**Rate Limit Exceeded Response:**
```json
{
  "error": "Too many requests. Please try again later.",
  "retryAfter": 45
}
```

## Authentication Endpoints

### POST /api/auth/sign-up

Create a new user account.

**Rate Limit:** 20 requests per 15 minutes

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "password123",
  "name": "John Doe"
}
```

**Response:** `200 OK`
```json
{
  "user": {
    "id": "cm1abc123",
    "email": "user@example.com",
    "name": "John Doe",
    "emailVerified": false
  },
  "session": {
    "token": "session_token_here",
    "expiresAt": "2025-10-17T20:54:00.000Z"
  }
}
```

**Errors:**
- `400` - Invalid email or password
- `409` - Email already exists
- `429` - Rate limit exceeded

---

### POST /api/auth/sign-in

Sign in to an existing account.

**Rate Limit:** 20 requests per 15 minutes

**Request Body:**
```json
{
  "email": "user@example.com",
  "password": "password123"
}
```

**Response:** `200 OK`
```json
{
  "user": {
    "id": "cm1abc123",
    "email": "user@example.com",
    "name": "John Doe"
  },
  "session": {
    "token": "session_token_here",
    "expiresAt": "2025-10-17T20:54:00.000Z"
  }
}
```

**Errors:**
- `401` - Invalid credentials
- `429` - Rate limit exceeded

---

### POST /api/auth/sign-out

Sign out and invalidate the current session.

**Rate Limit:** 20 requests per 15 minutes

**Authentication:** Required

**Response:** `200 OK`
```json
{
  "success": true
}
```

---

### GET /api/auth/session

Get the current user session.

**Rate Limit:** 60 requests per minute

**Response:** `200 OK`
```json
{
  "user": {
    "id": "cm1abc123",
    "email": "user@example.com",
    "name": "John Doe",
    "image": null
  },
  "session": {
    "expiresAt": "2025-10-17T20:54:00.000Z"
  }
}
```

**No Session:** `401 Unauthorized`

---

## Ticket Endpoints

### GET /api/tickets

Get all available tickets.

**Rate Limit:** 30 requests per minute

**Query Parameters:**
- `category` (optional): Filter by category (CONCERT, SPORTS, THEATER, FESTIVAL)
- `limit` (optional): Number of results per page (default: 50, max: 100)
- `offset` (optional): Pagination offset (default: 0)

**Example Request:**
```
GET /api/tickets?category=CONCERT&limit=20&offset=0
```

**Response:** `200 OK`
```json
{
  "tickets": [
    {
      "id": "cm1ticket123",
      "title": "Rock Concert 2025",
      "description": "Amazing rock concert featuring top bands",
      "price": 89.99,
      "category": "CONCERT",
      "eventDate": "2025-11-15T19:00:00.000Z",
      "location": "Madison Square Garden, NYC",
      "quantity": 100,
      "available": 75,
      "sellerId": "cm1user123",
      "createdAt": "2025-10-10T20:54:00.000Z",
      "updatedAt": "2025-10-10T20:54:00.000Z",
      "seller": {
        "id": "cm1user123",
        "name": "John Doe",
        "email": "john@example.com"
      }
    }
  ],
  "total": 1,
  "limit": 20,
  "offset": 0
}
```

---

### GET /api/tickets/[id]

Get details for a specific ticket.

**Rate Limit:** 60 requests per minute

**Path Parameters:**
- `id`: Ticket ID

**Example Request:**
```
GET /api/tickets/cm1ticket123
```

**Response:** `200 OK`
```json
{
  "id": "cm1ticket123",
  "title": "Rock Concert 2025",
  "description": "Amazing rock concert featuring top bands",
  "price": 89.99,
  "category": "CONCERT",
  "eventDate": "2025-11-15T19:00:00.000Z",
  "location": "Madison Square Garden, NYC",
  "quantity": 100,
  "available": 75,
  "sellerId": "cm1user123",
  "createdAt": "2025-10-10T20:54:00.000Z",
  "updatedAt": "2025-10-10T20:54:00.000Z",
  "seller": {
    "id": "cm1user123",
    "name": "John Doe",
    "email": "john@example.com"
  }
}
```

**Errors:**
- `404` - Ticket not found

---

### POST /api/tickets

Create a new ticket listing.

**Rate Limit:** 10 requests per minute

**Authentication:** Required

**Request Body:**
```json
{
  "title": "Rock Concert 2025",
  "description": "Amazing rock concert featuring top bands",
  "price": 89.99,
  "category": "CONCERT",
  "eventDate": "2025-11-15T19:00:00.000Z",
  "location": "Madison Square Garden, NYC",
  "quantity": 100
}
```

**Field Validations:**
- `title`: Required, string, max 200 characters
- `description`: Required, string, max 2000 characters
- `price`: Required, positive number
- `category`: Required, one of: CONCERT, SPORTS, THEATER, FESTIVAL
- `eventDate`: Required, ISO 8601 date string, must be in the future
- `location`: Required, string, max 300 characters
- `quantity`: Required, positive integer

**Response:** `201 Created`
```json
{
  "id": "cm1ticket123",
  "title": "Rock Concert 2025",
  "description": "Amazing rock concert featuring top bands",
  "price": 89.99,
  "category": "CONCERT",
  "eventDate": "2025-11-15T19:00:00.000Z",
  "location": "Madison Square Garden, NYC",
  "quantity": 100,
  "available": 100,
  "sellerId": "cm1user123",
  "createdAt": "2025-10-10T20:54:00.000Z",
  "updatedAt": "2025-10-10T20:54:00.000Z"
}
```

**Errors:**
- `400` - Invalid request body or validation error
- `401` - Not authenticated
- `429` - Rate limit exceeded

---

### PUT /api/tickets/[id]

Update an existing ticket listing.

**Rate Limit:** 10 requests per minute

**Authentication:** Required (must be ticket owner)

**Path Parameters:**
- `id`: Ticket ID

**Request Body:** (all fields optional)
```json
{
  "title": "Updated Concert Title",
  "description": "Updated description",
  "price": 99.99,
  "quantity": 150
}
```

**Response:** `200 OK`
```json
{
  "id": "cm1ticket123",
  "title": "Updated Concert Title",
  /* ... other fields ... */
  "updatedAt": "2025-10-10T21:00:00.000Z"
}
```

**Errors:**
- `400` - Invalid request body
- `401` - Not authenticated
- `403` - Not the ticket owner
- `404` - Ticket not found
- `429` - Rate limit exceeded

---

### DELETE /api/tickets/[id]

Delete a ticket listing.

**Rate Limit:** 10 requests per minute

**Authentication:** Required (must be ticket owner)

**Path Parameters:**
- `id`: Ticket ID

**Response:** `204 No Content`

**Errors:**
- `401` - Not authenticated
- `403` - Not the ticket owner
- `404` - Ticket not found
- `409` - Cannot delete ticket with existing purchases
- `429` - Rate limit exceeded

---

## Purchase Endpoints

### GET /api/purchases

Get all purchases for the authenticated user.

**Rate Limit:** 30 requests per minute

**Authentication:** Required

**Query Parameters:**
- `limit` (optional): Number of results per page (default: 50, max: 100)
- `offset` (optional): Pagination offset (default: 0)

**Response:** `200 OK`
```json
{
  "purchases": [
    {
      "id": "cm1purchase123",
      "ticketId": "cm1ticket123",
      "buyerId": "cm1user456",
      "quantity": 2,
      "total": 179.98,
      "createdAt": "2025-10-10T20:54:00.000Z",
      "ticket": {
        "id": "cm1ticket123",
        "title": "Rock Concert 2025",
        "eventDate": "2025-11-15T19:00:00.000Z",
        "location": "Madison Square Garden, NYC",
        "category": "CONCERT"
      }
    }
  ],
  "total": 1,
  "limit": 50,
  "offset": 0
}
```

**Errors:**
- `401` - Not authenticated
- `429` - Rate limit exceeded

---

### POST /api/purchases

Purchase tickets.

**Rate Limit:** 5 requests per minute (strict limit)

**Authentication:** Required

**Request Body:**
```json
{
  "ticketId": "cm1ticket123",
  "quantity": 2
}
```

**Field Validations:**
- `ticketId`: Required, valid ticket ID
- `quantity`: Required, positive integer, cannot exceed available quantity

**Response:** `201 Created`
```json
{
  "id": "cm1purchase123",
  "ticketId": "cm1ticket123",
  "buyerId": "cm1user456",
  "quantity": 2,
  "total": 179.98,
  "createdAt": "2025-10-10T20:54:00.000Z",
  "ticket": {
    "id": "cm1ticket123",
    "title": "Rock Concert 2025",
    "price": 89.99
  }
}
```

**Business Logic:**
- Automatically sets `buyerId` to authenticated user
- Calculates `total` as `price Ã— quantity`
- Decreases ticket's `available` count by `quantity`
- Creates purchase record with timestamp

**Errors:**
- `400` - Invalid request body or insufficient tickets available
- `401` - Not authenticated
- `403` - Cannot purchase your own tickets
- `404` - Ticket not found
- `409` - Insufficient tickets available
- `429` - Rate limit exceeded

---

## Error Codes

### 400 Bad Request
Invalid request parameters or body.

### 401 Unauthorized
Authentication required but not provided or invalid.

### 403 Forbidden
Authenticated but not authorized to perform action.

### 404 Not Found
Requested resource does not exist.

### 409 Conflict
Request conflicts with current state (e.g., email already exists).

### 429 Too Many Requests
Rate limit exceeded. Check `Retry-After` header.

### 500 Internal Server Error
Server error. Contact support if persists.

## Code Examples

### JavaScript/TypeScript

**Sign In:**
```typescript
const response = await fetch('/api/auth/sign-in', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    email: 'user@example.com',
    password: 'password123',
  }),
  credentials: 'include', // Important for cookies
});

const data = await response.json();
```

**Get Tickets:**
```typescript
const response = await fetch('/api/tickets?category=CONCERT', {
  credentials: 'include',
});

const { tickets } = await response.json();
```

**Create Ticket:**
```typescript
const response = await fetch('/api/tickets', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  credentials: 'include',
  body: JSON.stringify({
    title: 'My Event',
    description: 'Event description',
    price: 50.0,
    category: 'CONCERT',
    eventDate: '2025-12-01T19:00:00.000Z',
    location: 'Event Venue',
    quantity: 100,
  }),
});

const ticket = await response.json();
```

**Purchase Tickets:**
```typescript
const response = await fetch('/api/purchases', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  credentials: 'include',
  body: JSON.stringify({
    ticketId: 'cm1ticket123',
    quantity: 2,
  }),
});

const purchase = await response.json();
```

### cURL

**Sign In:**
```bash
curl -X POST http://localhost:3000/api/auth/sign-in \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"password123"}' \
  -c cookies.txt
```

**Get Tickets:**
```bash
curl http://localhost:3000/api/tickets?category=CONCERT \
  -b cookies.txt
```

**Create Ticket:**
```bash
curl -X POST http://localhost:3000/api/tickets \
  -H "Content-Type: application/json" \
  -b cookies.txt \
  -d '{
    "title":"My Event",
    "description":"Event description",
    "price":50.0,
    "category":"CONCERT",
    "eventDate":"2025-12-01T19:00:00.000Z",
    "location":"Event Venue",
    "quantity":100
  }'
```

## Next Steps

- [Authentication Guide](/docs/authentication) - Learn about authentication
- [Database Schema](/docs/database) - Understand the data structure
- [Rate Limiting](/docs/rate-limiting) - Learn about rate limits
